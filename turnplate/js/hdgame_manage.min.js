(function(g,j){j.moduleLayer={isSelected:false,selectedElem:null,isDrag:false,isCancel:true,isScroll:false,offsetParent:null,scrollParent:null};var c=(function(){var n=1;return function(o){var p=o.data("layerId");if(!p){p="layerId-"+n;o.addClass(p);o.data("layerId",p);n++}}})();function l(p){var o,n=p.parent();while(!n.is(g("body"))){o=n.scrollTop();n.scrollTop(o==0?o+1:o-1);if(n.scrollTop()!=o){n.scrollTop(o);if(p[0].nodeName=="DIV"&&p.css("position")=="static"){p.css("position","relative")}j.moduleLayer.scrollParent=n;return true}n=n.parent()}return false}function b(o){var p=g("."+o);var q=["Left","Right","Top","Bottom"];var n="";g.each(q,function(r,s){if(g("#"+o+"moveFrame"+s).length==0){n+='<div id="'+o+"moveFrame"+s+'" class="moveFrame" style="border-'+s.toLowerCase()+'-width:1px"></div>'}});if(n){if(p.data("isScrollAble")){if(p[0].nodeName=="IMG"){p.parent().append(n)}else{p.append(n)}}else{g("body").append(n)}d(p)}!g_config.isVersion3&&g(".moveFrame").each(function(r,s){if(g(this).attr("id").indexOf(o)!=-1){g(this).css({borderColor:"#dcdcdc",background:"transparent"})}})}function d(n,s){var o=n.data("layerId");var p=n.offset().left;var x=n.offset().top;var u=n.outerWidth();var q=n.outerHeight();if(n.data("isScrollAble")){g("#"+o+"moveFrameLeft").css({left:0,top:0,width:0,height:q,borderLeftWidth:1});g("#"+o+"moveFrameRight").css({left:u-1,top:0,width:0,height:q,borderRightWidth:1});g("#"+o+"moveFrameTop").css({left:0,top:0,width:u,height:0,borderTopWidth:1});g("#"+o+"moveFrameBottom").css({left:0,top:q-1,width:u,height:0,borderBottomWidth:1})}else{g("#"+o+"moveFrameLeft").css({left:p,top:x,width:0,height:q,borderLeftWidth:1});g("#"+o+"moveFrameRight").css({left:p+u-1,top:x,width:0,height:q,borderRightWidth:1});g("#"+o+"moveFrameTop").css({left:p,top:x,width:u,height:0,borderTopWidth:1});g("#"+o+"moveFrameBottom").css({left:p,top:x+q-1,width:u,height:0,borderBottomWidth:1})}if(s){var y=n.closest(".ui-wrapper");if(y.length==0){y=n}var v=y.find(".recoverBtn");var r=false;if(u<2*v.width()){r=true}if(q<2*v.height()){r=true}if(r&&!n.data("_minRecoverBtn")){n.data("_minRecoverBtn",true);y.find(".ui-resizable-imgTopRightTip").css({backgroundPositionX:0,backgroundPositionY:11,right:-11,top:-11});y.find(".ui-resizable-imgTopLeftTip").css({backgroundPositionX:11,backgroundPositionY:11,left:-11,top:-11});y.find(".ui-resizable-imgBottomLeftTip").css({backgroundPositionX:11,backgroundPositionY:0,left:-11,bottom:-11});y.find(".ui-resizable-imgBottomRightTip").css({backgroundPositionX:0,backgroundPositionY:0,right:-11,bottom:-11});v.css("right",-24)}else{if(n.data("_minRecoverBtn")){n.data("_minRecoverBtn",false);y.find(".ui-resizable-imgTopRightTip").css({backgroundPositionX:11,backgroundPositionY:0,right:0,top:0});y.find(".ui-resizable-imgTopLeftTip").css({backgroundPositionX:0,backgroundPositionY:0,left:0,top:0});y.find(".ui-resizable-imgBottomLeftTip").css({backgroundPositionX:0,backgroundPositionY:11,left:0,bottom:0});y.find(".ui-resizable-imgBottomRightTip").css({backgroundPositionX:11,backgroundPositionY:11,right:0,bottom:0});v.css("right",3)}}}}j.removeMoveFrame=function(n){g("#"+n+"moveFrameLeft,#"+n+"moveFrameRight,#"+n+"moveFrameTop,#"+n+"moveFrameBottom").remove();$$("#imgSizeShow").hide()};j.removeAllEditLayer=function(){g(".moveFrame").remove();g(".moduleLayer").remove();g("#playerTopBar").trigger("mbtpBlur");g(".recoverBtn").hide();g(".ui-resizable-handle").hide();if(j.moduleLayer.selectedElem){if(j.moduleLayer.selectedElem[0].nodeName=="IMG"&&j.moduleLayer.selectedElem.attr("id")=="tree3"){j.moduleLayer.selectedElem.css("z-index",j.moduleLayer.selectedElem.data("z-index"));j.moduleLayer.offsetParent.css("z-index",g("#tree1").data("z-index"))}else{j.moduleLayer.offsetParent.css("z-index",j.moduleLayer.selectedElem.data("z-index"))}j.moduleLayer.selectedElem=null;j.moduleLayer.offsetParent=null}j.moduleLayer.isSelected=false;j.moduleLayer.isScroll=false};j.getPosition=function(t,v,B,D){var u=t.parent().position();if(t.attr("id")=="resule-gift-sucImg"){return}if(v.left&&v.top){u={left:v.left,top:v.top}}if(u.left==0&&u.top==0&&!D){var x=t.parent().position();if(x.left!=0||x.top!=0){u=x}}if(D){var z=e({left:(v.width-B.width)/2,top:(v.height-B.height)/2},B);return z}if(!t.parent().is(":visible")){u.left=parseFloat(t.parent().css("left"));u.top=parseFloat(t.parent().css("top"))}var n=j.getLackBorder(t);var o={width:t.parent().width(),height:t.parent().height()};if(n){var H,w;var r=u.left+o.width/2;var q=u.top+o.height/2;var C=t.data("theLimitOneData");if(!C){var G;switch(n){case"n":w=u.top;G=w;H=r-B.width/2;break;case"e":w=q-B.height/2;G=u.left+o.width;H=u.left+o.width-B.width;break;case"s":w=u.top+o.height-B.height;H=r-B.width/2;G=u.top+o.height;break;case"w":w=q-B.height/2;H=u.left;G=u.left;break}t.data("theLimitOneData",G)}else{switch(n){case"n":w=C;H=r-B.width/2;break;case"e":w=q-B.height/2;H=C-B.width;break;case"s":w=C-B.height;H=r-B.width/2;break;case"w":w=q-B.height/2;H=C;break}}n=null;var y=e({left:H,top:w},B);return y}else{var s;var A=t.data("defData");if(A&&A.left){s={left:parseRemToPx(A.width)/2+parseRemToPx(A.left),top:parseRemToPx(A.height)/2+parseRemToPx(A.top)}}else{s=t.data("defPositionData");if(!s){var r=u.left+o.width/2;var q=u.top+o.height/2;s={left:r,top:q};t.data("defPositionData",{left:r,top:q})}}var y=e({left:s.left-B.width/2,top:s.top-B.height/2},B);var p=24*g_rem;var F=16*g_rem;var E=t.closest(".editPositionWap");if(E.length>0){p=E.height()||p;F=E.width()||F}if(B.width+y.left>F){y.left=16*g_rem-B.width}if(B.height+y.top>p){y.top=24*g_rem-B.height}return y}};function e(q,n){var p=q.left;var o=q.top;if(q.left<0){p=0}if(q.top<0){o=0}return{left:p,top:o}}j.getLackBorder=function h(r){var n=r.data("resizable");if(n&&n.options&&n.options.handles){var q=["n","e","s","w","ne","nw","sw","se"];var s=n.options.handles.split(",");g.each(s,function(t,w){var u=false;var v=0;g.each(q,function(y,x){if(x==w){q.splice(y,1);return false}})});var p;var o=0;g.each(q,function(t,u){if(u.length==1){p=u;return false}});g.each(q,function(t,u){if(u.length>1&&u.indexOf(p)>=0){o++}});if((q.length-o)==1){return p}return false}return false};(function(){var o={};var n={};var p=0;j.saveModuleLayerImg=function(r,q){if(typeof r=="function"){o["_cb"+(p++)]=r}else{if(r&&r.length>0){g.each(r,function(t,s){if(!s.from){return}o[s.from]=s.defSrc;q&&(n[s.from]=q)})}}};j.getModuleLayerImg=function(){var r=[];g.each(o,function q(t,w){if(typeof w=="function"){w=w();if(g.isArray(w)||(g.isPlainObject(w)&&!w.from)){g.each(w,q);return}}if(g.isPlainObject(w)){t=w.from;w=w.defSrc}var u=g(t),v,s;if(u.length>0){v={selecter:t,elem:u,defSrc:w,};if(s=n[t]){v.edit=s}r.push(v)}});return r}})();j.initModuleLayer=k(function(r,q,t,o,s,u,n){if(r.data("_hasBin")){return}r.data("_hasBin",true);c(r);var p=false;if(q==2){r.each(function(v,w){if(this.nodeName=="IMG"){p=true;return false}})}if(q==-1||p){if(r.attr("id")=="ruleImg"){}if(r.length>0){r.on("load",function(A){var w=g(this).data("your-Original-Size");if(!w){return}var z=g(this).data("defData");var x;if(!z){x={width:g(this).parent().width(),height:g(this).parent().height()}}else{x={width:parseRemToPx(z.width),height:parseRemToPx(z.height)}}var y=j.Img.calcSize(w.width,w.height,x.width,x.height,j.Img.MODE_SCALE_DEFLATE_FILL);var C=j.getPosition(g(this),x,y);var v=g(this);g(this).hasClass("slaveImg")&&!g(this).hasClass("notNeedFatherChage")&&(v=g(this).add(g(this).parent()));v.css({width:y.width,height:y.height});var B=g.extend({},y);B=g.extend(B,C);if(g(this).attr("id")!="resule-gift-sucImg"){v.css({left:C.left,top:C.top})}else{$$(function(){var D=parent.game.$checkeIndex;parent.game._awardList[D].aimgw=parsePxToRem(y.width+"px");parent.game._awardList[D].aimgh=parsePxToRem(y.height+"px")})}g(this).hdTrigger("hd-resizable-autoChange",[this,B,C]);g(this).removeData("your-Original-Size").attr("resize","1")})}}r.on("selectstart",function(){return false});r.attr("title","点击后编辑");r.addClass("defBgColor");r.data("mouseover",function(w){if(g(this).css("cursor")!=="move"){g(this).css("cursor","pointer")}if((g(this).hasClass("codeOptInfo")&&(g(this).text()=="复制口令发送到公众号"||g(this).text()=="复制券码发送到公众号"))||((g(this).find(".text").css("display")=="inline"&&(g(".codeOptInfo").text()=="复制口令发送到公众号"||g(".codeOptInfo").text()=="复制券码发送到公众号"))&&!g(this).hasClass("servicePhone"))||g(this).hasClass("disableBtn")){g(this).css("cursor","default")}if(g(this).data("moduleLayerDisable")){g(this).attr("title","");return}var v=g(this).data("layerId");if(!g(this).data("hd-moduleLayerList")){g(this).attr("title","")}if(!g(this).data("isScrollAble")){g(this).data("isScrollAble",l(g(this)))}clearTimeout(g(this).data("initModuleTimer"));if(j.ResizeDoc||g("#"+v+"moduleLayer").length>0||g(this).hasClass("answerItem")||g(this).hasClass("answer")||g(this).hasClass("thePcEgg")||g(this).attr("id")=="shake"||g(this).attr("id")=="selfAwardLine"){return}b(v)});r.off("mouseover").off("mouseleave").on("mouseover",r.data("mouseover")).on("mouseleave",function(w){var v=g(this).data("layerId");g(this).data("initModuleTimer",setTimeout(function(){if((!j.ResizeDoc&&!j.moduleLayer.isSelected)||(j.moduleLayer.isSelected&&(j.moduleLayer.selectedElem[0]!=w.target&&j.moduleLayer.selectedElem[0]!=g(w.target).closest("."+v)[0]))){j.removeMoveFrame(v);g("#"+v+"moduleLayer").remove()}},100))}).on("click",function(y){y.stopPropagation();if(g(this).data("moduleLayerDisable")){return}if(!j.moduleLayer.isDrag){var v=g(this).parent().data("layerId")?g(this).parent().data("layerId"):g(this).data("layerId");if(!g(this).is(j.moduleLayer.selectedElem)){j.removeAllEditLayer()}b(v);a(v);!g_config.isVersion3&&g(".moveFrame").css({borderColor:"#2B73BA",background:"#79cef9"});if(g(this).children(".ui-resizable-handle")[0]){g(this).children(".ui-resizable-handle").show()}else{g(this).siblings(".ui-resizable-handle").show()}if(g(this).attr("resize")==1||g(this).parent().attr("resize")==1){var w=g(this).closest(".ui-wrapper");if(w.length>0){w.find(".recoverBtn").show()}else{if(g(this).hasClass("thePcEgg")||g(this).attr("id")=="shake"){g(this).siblings(".recoverBtn").show()}else{g(this).find(".recoverBtn").show()}}}j.moduleLayer.isSelected=true;if(j.moduleLayer.selectedElem){j.moduleLayer.offsetParent.css("z-index",j.moduleLayer.selectedElem.data("z-index"))}if(g(this)[0].nodeName=="IMG"){if(g(this).hasClass("student")||g(this).hasClass("teacher")||g(this).hasClass("clickBtn")){var x=g(this);j.moduleLayer.offsetParent=g(this);while(x.parent()[0]!=document){if(x.parent().css("z-index")!="auto"){j.moduleLayer.offsetParent=x.parent()}x=x.parent()}}else{if(g(this).closest("#logoImgBox")[0]){j.moduleLayer.offsetParent=g(this).closest("#logoImgBox")}else{if(!g(this).closest(".imgContainer")[0]){j.moduleLayer.offsetParent=g(this)}else{j.moduleLayer.offsetParent=g(this).closest(".imgContainer")}}}}else{if(g(this).closest(".imgContainer").length>0){j.moduleLayer.offsetParent=g(this).closest(".imgContainer")}else{j.moduleLayer.offsetParent=g(this)}}g(this).data("z-index",j.moduleLayer.offsetParent.css("z-index"));j.moduleLayer.offsetParent.css("z-index","700");if(g(this).attr("id")==="resule-status-lots"){j.moduleLayer.offsetParent.css({height:"0px"})}if(g(this).attr("id")=="shake"||g(this).hasClass("editTarget-egg")){j.moduleLayer.selectedElem=g(this).parent();return}if(g(this).attr("id")=="tree1"&&parent.$("#editActive").find(".topBar .checked .name").text()=="挑战成功"){g("#tree3").data("z-index",g("#tree3").css("z-index")).css("z-index",200);j.moduleLayer.selectedElem=g("#tree3");return}j.moduleLayer.selectedElem=g(this)}else{j.moduleLayer.isDrag=false}}).on("dblclick",function(x){if(g(this).data("disdbl")){return}if(g(this).data("moduleLayerDisable")){return}var w=g(this).data("layerId");a(w);var v=g("#"+w+"moduleLayer");if(v.children().length!=0&&(!s||g(this).find("img")[0]||g(this)[0].nodeName)){var y=v.children().length-1;v.children().eq(y).click();x.preventDefault();x.stopPropagation()}else{v.children().each(function(z,A){if(g(A).text()=="样式设置"||g(A).text()=="样式"||g(A).text()=="文字颜色"){g(A).click();x.preventDefault();x.stopPropagation()}})}});if(n||q!=-2){j.saveModuleLayerImg(o,r);j.addModuleLayer(r,{name:typeof n==="string"?n:"编辑",onclick:function(w){j.moduleLayer.isCancel=false;setTimeout(function(){j.moduleLayer.isCancel=true},10);parent.Edit.showEditByGame.call(w.data.target,q,t,o);parent.operateFlagList[17]=true;j.logPhoneDog(3);if(t=="awardSetting"){var v=g(this).data("layerId");j.removeMoveFrame(v);g("#"+v+"moduleLayer").remove()}g(w.data.target).hdTrigger("hd-clickEditBtn",[q,t,o]);return false}})}if(s){j.addModuleLayer(r,{name:typeof s==="string"?s:"样式",onclick:function(v){parent.Edit.Css.showCssByGame.call(v.data.target,t,u);parent.operateFlagList[21]=true;j.logPhoneDog(5);return false}})}r.trigger("hd-moduleLayer-after");r=null});j.addModuleLayer=k(function(p,o){var n=p.data("hd-moduleLayerList");if(!n){n=[]}n.push(o);p.data("hd-moduleLayerList",n)});function a(q){var n=q+"moduleLayer";var t=g("."+q);var o=t.data("hd-moduleLayerList");if(!o){return}g("#"+n).remove();var u=g("<div id='"+n+"' class='moduleLayer' _mouseIn='0'></div>");if(g(t).data("isScrollAble")&&!t.is(g("#ruleBox").children().first())){if(t[0].nodeName=="IMG"){t.parent().append(u)}else{t.append(u)}}else{g("body").append(u)}var r=false;var s=function(x){if(!x||!x.onclick){return}var w;if(x.html){w=g(x.html)}else{var y=x["class"]?(" "+x["class"]):"";var v=x.name;if(r){if(x.name=="编辑"){v='<span class="s-btn edit-btn"></span>'}else{if(x.name=="样式"){v='<span class="s-btn css-btn"></span>'}}}w=g("<a class='item tool"+y+"' hidefocus='true' href='javascript:;'>"+v+"</a>")}u.append(w);x.data=x.data||{};x.data.target=t;w.on("click",x.data,x.onclick);x.onshow&&x.onshow.call(w,x.data)};for(var p=o.length-1;p>=0;p--){s(o[p])}u.css("margin",0);i(t,u);u.mouseover(function(){clearTimeout(t.data("initModuleTimer"))}).mouseleave(function(v){if(!j.moduleLayer.isSelected){t.data("initModuleTimer",setTimeout(function(){j.removeMoveFrame(q);g("#"+n).remove();var w=t.siblings(".ui-resizable-handle,.recoverBtn");w=(w.length>0)?w:(t.find(".ui-resizable-handle,.recoverBtn"));w.siblings(".ui-resizable-handle,.recoverBtn").hide()},100))}});return u}function m(t,n){var y=t.outerWidth();var A=t.outerHeight();var p=n.outerWidth();var s=n.outerHeight();var q=g(window).width();var r=t.offset();var u=3;var o=2;var w=r.left+y-p-o;if(w<0){w=0}else{if(w+p>q){w=q-p}}var v=r.top-s-u;var x=t.data("isScrollAble");var B=x&&t.is(g("#ruleBox .poupMainInfo").children().first());if(x&&(!B||n.parent().is(t))){w=w-r.left;if(B){v=u}else{var z=j.moduleLayer.scrollParent.scrollTop();v=v>0||z-n.outerHeight()>0?-n.height()-1:-t.offset().top}}else{v=v>0?v:r.top+u}n.css("left",w);n.css("top",v)}function i(p,n){if(!n){n=g(".moduleLayer")}if(n.length<1){return}if(g_config.isVersion3){return m(p,n)}var u=p.outerWidth();var s=p.offset().left+u-n.outerWidth()-2;if(s<0){s=0}if(p.offset().left<g(window).width()&&p.offset().left+u>g(window).width()){s=g(window).width()-n.outerWidth()-1}var r=(p.offset().top-n.height()-1);var t=p.data("isScrollAble");if(t){var q=g("#ruleBox .poupMainInfo");var w=q.children().first();var x=p.is(w)}if(t&&(!x||n.parent().is(p))){n.css("left",s-p.offset().left);if(x){var o=parseFloat(w.css("margin-top"));if(isNaN(o)){o=0}n.css("top",0)}else{var v=j.moduleLayer.scrollParent.scrollTop();n.css("top",r>0||v-n.outerHeight()>0?-n.height()-1:-p.offset().top)}}else{n.css("left",s);n.css("top",r>0?r:p.offset().top+1)}}g("#ruleBox .poupMainInfo").on("scroll",function(){j.moduleLayer.isScroll=true;var o=g(this);if(j.moduleLayer.isSelected){var r=o.children().first();var n=j.moduleLayer.selectedElem.data("layerId");var q=g("#"+n+"moduleLayer");if(r.is(j.moduleLayer.selectedElem)){if(!q.parent().is(r)){q.css({left:0,top:0});r.append(q);i(j.moduleLayer.selectedElem)}var p=parseFloat(r.css("margin-top"));if(isNaN(p)){p=0}q.css("top",0)}}});j.moduleSlaveImgResize=k(function(r,s,t){var n=t||"body";if(r.parents(".home").length>0||r.parents(".zlEnterHome").length>0){n="#limitRange"}r.parent("div.ui-wrapper").css({padding:"0"});r.resizable("destroy");var o=g(r).parents("div.imgContainer");var p=o.find(".slaveImg");if(o.length==0){o=r}if(p.length==0){p=r}c(p);p.data("defData",s);var q={handles:"n,e,s,w,ne,nw,sw,se",autoHide:true,maxWidth:16*g_rem,maxHeight:g_config.minBgH*g_rem,minWidth:20,minHeight:20,aspectRatio:true,containment:n,alsoResize:r,create:function(u,v){var x=g(this);if(Math.abs(x.width()-parseRemToPx(s.width))>1||Math.abs(x.height()-parseRemToPx(s.height))>1){p.attr("resize",1)}x.css({position:"relative","float":"none","z-index":x.attr("_zindex")||100});if(x.width()<40||x.height()<40){x.css("padding","2px")}else{x.css("padding","0")}x.append("<a class='recoverBtn' href='javascript:;'></a>");x.find(".recoverBtn").on("click",function(A){g(this).hide();p.attr("resize",0);var B=p.data("defData")||s;x.add(p).css(B);var D=x[0].offsetLeft+x[0].offsetWidth;var C=x[0].offsetTop+x[0].offsetHeight;if(D>g(document).width()){x.css("left",g(document).width()-x[0].offsetWidth-1)}if(C>g(document).height()){var y=g(".bottomSkill")[0];var z=(y&&y.offsetHeight)||0;x.css("top",g(document).height()-x[0].offsetHeight-z-1)}j.logPhoneDog(4);p.hdTrigger("hd-resizable-recover",[A,B,x]);setTimeout(function(){i(p);d(p,true);g("#resule-gift-sucImg").trigger("hd-resizable-resize")},10);parent.changeIsSave()});x.attr("_from",p.attr("id"));(function(){var A=[["s","Bottom"],["n","Top"],["w","Left"],["e","Right"]];for(var z=0;z<4;z++){x.children(".ui-resizable-"+A[z][0]).addClass("ui-resizable-img"+A[z][1]+"Tip").css({"z-index":"9030"});if(z<2){for(var y=2;y<4;y++){x.children(".ui-resizable-"+A[z][0]+A[y][0]).addClass("ui-resizable-img"+A[z][1]+A[y][1]+"Tip").css({"z-index":"9030"})}}}})();var w=x.parent();x.children(".ui-resizable-handle").mousedown(function(z){var y=w.attr("href");if(typeof y!="undefined"&&y.length>0){w.removeAttr("href");w.attr("onclick","return false;")}});if(p.data("layerId")){p.off("mouseover").off("mouseleave")}x.mouseover(function(){clearTimeout(p.data("initModuleTimer"));if(j.ResizeDoc){return}if(p.data("layerId")){p.data("mouseover").call(p)}p.removeData("resizable-isLeave")}).mouseleave(function(){p.data("initModuleTimer",setTimeout(function(){if((!j.ResizeDoc&&!j.moduleLayer.isSelected)||(j.moduleLayer.isSelected&&(p.parent()[0]!=j.moduleLayer.selectedElem[0]&&p[0]!=j.moduleLayer.selectedElem[0]&&!j.moduleLayer.selectedElem.is(g("#tree3"))))){var y=p.data("layerId");j.removeMoveFrame(y);g("#"+y+"moduleLayer").remove();x.children(".ui-resizable-handle").hide();o.find(".recoverBtn").hide()}else{p.data("resizable-isLeave",true)}},100))});p.hdTrigger("hd-resizable-create",[u,v])},start:function(u,v){if(v.axis.length===2){g(this).resizable("option","aspectRatio",true)}else{g(this).resizable("option","aspectRatio",false)}p.data("cursor",p.css("cursor"));b(p.data("layerId"));j.ResizeDoc=o;$$("#imgSizeShow").show();g("#"+p.data("layerId")+"moduleLayer").remove();v.originalElement.parent().find(".recoverBtn").hide();g(this).css("position","relative");g(".ui-resizable-bottomTip,.ui-resizable-cancelTip,.draggableBtn").css({opacity:"0"});p.hdTrigger("hd-resizable-start",[u,v]);g(".ui-resizable-handle").hide()},resize:function(v,w){parent.changeIsSave();p.hdTrigger("hd-resizable-resize",[v,w]);if(p.closest(".ui-wrapper").length>0){p.closest(".ui-wrapper").css("cursor","")}else{p.children().css("cursor","")}p.css("cursor","");d(p,true);var u=$$("#imgSizeShow");u.find("span").eq(0).text(Math.round(p.width())*2);u.find("span").eq(1).text(Math.round(p.height())*2);u.css({width:"auto",height:"auto",top:v.pageY+15,left:v.pageX-30})},stop:function(y,z){if(j.moduleLayer.isSelected){p.click()}delete j.ResizeDoc;if(p.data("resizable-isLeave")){g(this).mouseleave();p.removeData("resizable-isLeave")}else{p.mouseover()}if(p.closest(".ui-wrapper").length>0){p.closest(".ui-wrapper").css("cursor",p.data("cursor"))}p.css("cursor",p.data("cursor"));$$("#imgSizeShow").hide();g(".ui-resizable-bottomTip,.ui-resizable-cancelTip,.draggableBtn").css({opacity:"1"});o.find(".slaveImg").attr("resize","1");o.find(".recoverBtn").show();if(g(this).width()<40||g(this).height()<40){g(this).css("padding","2px")}else{g(this).css("padding","0")}var A=g(this).parent();var x=A.attr("link");if(typeof x!="undefined"&&x.length>0){setTimeout(function(){A.attr("href",x);A.removeAttr("onclick")},100)}var w=g(this).data("defData");if(z.position&&z.size&&w&&!w.left){var u=z.position.left+z.size.width/2;var v=z.position.top+z.size.height/2;p.data("defPositionData",{left:u,top:v})}parent.operateFlagList[17]=true;j.logPhoneDog(0);p.hdTrigger("hd-resizable-stop",[y,z])}};r.hdTrigger("hd-resizable-before",[q]);r.resizable(q);r.off(".slaveImg").hdTrigger("hd-resizable-after")});j.moduleDraggale=k(function(t,r,u){var q=t.parent();var p=t;var o=u||"body";if(r){p=q}if(r===false){q=p}p.css("cursor","move");p.css("position","absolute");if(p.parents(".home").length>0||p.parents(".zlEnterHome").length>0||p.hasClass("drag_limitDef")){o="#limitRange"}if(g_config.style==69){o="#limitRange2"}var n=parseInt(q.css("z-index"));var s={start:function(v,w){t.mouseover();q.children(".ui-resizable-handle").hide();n=parseInt(q.css("z-index"));if(isNaN(n)){n=""}q.css("z-index","9999");t.hdTrigger("hd-draggable-start",[v,w])},drag:function(v,w){parent.changeIsSave();if(t[0].nodeName!="DIV"){j.moduleLayer.isDrag=true}d(t);g("#"+t.data("layerId")+"moduleLayer").remove();t.parent().find(".recoverBtn").hide();t.hdTrigger("hd-draggable-drag",[v,w])},stop:function(z,A){q.css("z-index",n);if(A.position){var y={width:q.outerWidth(),height:q.outerHeight()};var w=A.position.left+y.width/2;var x=A.position.top+y.height/2;t.data("defPositionData",{left:w,top:x});var v=j.getLackBorder(t);if(v){var B;switch(v){case"n":B=A.position.top;break;case"e":B=A.position.left+y.width;break;case"s":B=A.position.top+y.height;break;case"w":B=A.position.left;break}t.data("theLimitOneData",B)}}if(j.moduleLayer.isSelected){t.click();return}j.removeAllEditLayer();t.mouseover();parent.operateFlagList[17]=true;j.logPhoneDog(1);t.hdTrigger("hd-draggable-stop",[z,A])},opacity:0.5,scroll:false,distance:1,containment:o,addClasses:false};p.addResizableFn("recover",function(v,A,z){var y=z[0].offsetTop+z[0].offsetHeight;var x=g(s.containment);var w=x[0].offsetTop+x[0].offsetHeight;if(y>w){z.css("top",parseInt(z.css("top"))-(y-w))}});t.hdTrigger("hd-draggable-before",[s]);p.draggable(s);t.hdTrigger("hd-draggable-after")});function k(n){return function(){var r=this;var o=arguments.callee;var p=arguments[0];if(j.getType(p)==="array"){if(j.getType(p[0])==="array"){g.each(p,function(s,t){if(j.getType(t)==="array"){o.call(r,t)}})}else{o.apply(r,p)}}else{(typeof p==="string"||p.nodeType)&&(p=g(p));if(p instanceof jQuery&&p.length>0){var q=Array.prototype.slice.call(arguments);if(p.length>1){p.each(function(){q[0]=g(this);n.apply(r,q)})}else{q[0]=p;n.apply(r,q)}}return r}}}function f(o,r,q,n){var p="hd-"+q+"-"+n;if(p==="hd-resizable-before"||p==="hd-draggable-before"){o.on(p,function(t,s){g.extend(s,r)})}else{o.on(p,function(t){t.stopPropagation();var s=Array.prototype.slice.call(arguments);s.shift();r.apply(this,s)})}return o}g.fn.extend({hdTrigger:function(o,n){this.trigger.apply(this,arguments)},setResizableOption:function(n){return f(this,n,"resizable","before")},setDraggableOption:function(n){return f(this,n,"draggable","before")},addResizableFn:function(o,n){return f(this,n,"resizable",o)},addDraggableFn:function(o,n){return f(this,n,"draggable",o)},addEditUploadFn:function(o,n){return f(this,n,"editUpload",o)}});(function(n){g.extend(n,{swaping:false,delay:g_config.style==69?0:0.7,addBtn:o});function o(){j.addModuleLayer("#ruleBox .poupLine",{name:"下移",onshow:function(r){var s=r.target;var q=s.next();if(q.hasClass("noMove")){q=q.next()}if(q.length==0){g(this).hide()}else{g(this).show()}},onclick:function(r){r.stopPropagation();var s=r.data.target;var q=s.next();if(q.hasClass("noMove")){q=q.next()}if(q.length!=0){p(s,q,s)}parent.changeIsSave()}});j.addModuleLayer("#ruleBox .poupLine",{name:"上移",onshow:function(r){var s=r.target;var q=s.prev();if(q.hasClass("noMove")){q=q.prev()}if(q.length==0){g(this).hide()}else{g(this).show()}},onclick:function(r){r.stopPropagation();var s=r.data.target;var q=s.prev();if(q.hasClass("noMove")){q=q.prev()}if(q.length!=0){p(q,s,s)}parent.changeIsSave()}})}function p(s,r,u){if(n.swaping){return}n.swaping=true;j.removeAllEditLayer();var q=s.height();var t=r.height();s.animate({top:t+n.delay*g_rem},300);r.animate({top:-q-n.delay*g_rem},300,function(){n.swaping=false;s.insertAfter(r);s.css("top",0);r.css("top",0);u.click()})}})(j.sortRuleBox);j.bindModuleLayer=function(n){j.initModuleLayer("#awardDetailBox .codeTimeFixedRange,#awardDetailBox .codeTimeFixedTerm",1,"awardTime");if(!_preview){var o=parent.gameDef._awardList;g("#resule-gift-sucImg").css({width:parent.awardList[0].aimgw,height:parent.awardList[0].aimgh,}).attr("src",parent.awardList[0].aimg);hg.edit.cache["resule-gift-sucImg"]=g.map([1,2,3,4,5,6,7,8,900],function(w,v){var u={from:"#resule-gift-sucImg",limit:"5000k",title:j.getLevelName(w),defSrc:o[v].aimg,};if(w==900){if(!g_config.openComfort){u.hide=true}}else{if(v+1>g_config.awardNum){u.hide=true}}return u})}var r;switch(g_config.style){case 55:r=".gameBox";break;case 49:case 69:r=".body";break;case 67:r=".myCutDownPriceList";break;case 77:r=".cutDetailPage";break;default:r=".home"}var t=r+' .soundIcon:not(".soundIconPlay")';j.initModuleLayer([["#accessKeyPopupTitle",-6,"",""],["#joinNumLine",0,"joinNum",null,true],["#gameTopBar",-2,"gameTopBar",null,"样式设置"],["#logoImg",2,"logoImg"],["#awardLine,#selfAwardLine",1,"awardSetting"],["#gameDateTime",0,"gameTime"],["#explainBox,#awardExplainBox,#resule-gift-explain",0,"explain"],["#resule-status-count",2,"drawInfo"],[".hostLine",g_config.storeId==0?2:-2,"hostLine"],["#skillLine",1,"skillLine"],["#rankBox",1,"rankBox"],[".resule-status-minscore",2,"minscore"],[".menuBtnBox",2,"menuBtn"],["#awardDetailBox .awardName",1,"awardName"],["#awardDetailBox .awardSubTitle",1,"awardSubTitle"],["#awardDetailBox .timelimitLine",1,"timelimitLine"],["#awardDetailBox .addressLine",1,"addressLine"],["#awardDetailBox .noticeLine",1,"noticeLine"],["#awardDetailBox .awardCusBtn",1,"awardCusBtn"],["#awardDetailBox .bottomCusBtn",1,"bottomCusBtn"],[t,-2,"#limitRange"],["#awardDetailBox .codeOptInfo",1,"codeOptInfo"],["#awardDetailBox .webCashBtn",1,"webCashBtn"],["#awardDetailBox .servicePhone",1,"servicePhone"],["#awardDetailBox .jumptoHostInfo",1,"jumptoHostInfo"],["#resule-gift-sucImg",-1,"",hg.edit.cache["resule-gift-sucImg"]],["#titleImg",-1,"",[{from:"#titleImg",title:"标题图片",limit:"5000k",defSrc:n.titleImg_path_def}]],["#startBtnImg",-1,"",[{from:"#startBtnImg",title:"按钮图片",limit:"5000k",defSrc:n.startImg_path_def}]],["#ruleImg",-1,"",[{from:"#ruleImg",title:"活动奖品",limit:"5000k",defSrc:n.awardIconImgPath_def}]]]);if(!g_config.afterWxCard){j.initModuleLayer([["#awardDetailBox .awardCusText",1,"awardCusText"],[".codeImg",1,"codeImg"],])}g(".titleImg").addClass("abs");var q=[[g("#titleImg"),{width:n.titleImg_w_def,height:n.titleImg_h_def}],[g("#startBtnImg"),{width:n.startBtn_w_def,height:n.startBtn_h_def}],[g("#logoImg"),{width:n.logoImg_w_def,height:n.logoImg_h_def},"#limitRange"]];g_config.style!=84&&q.push([g("#ruleImg"),{width:n.awardIcon_w_def,height:n.awardIcon_h_def}]);j.moduleSlaveImgResize(q);j.moduleDraggale([["#titleImg",true],["#startBtnImg",true],["#logoImg",true,"#limitRange"],["#ruleImg",false,"#limitRange"],["#joinNumLine",false],["#drawInfo",false],[t,false]]);p(g("#logoImg").closest(".ui-wrapper"),120);p(g("#titleImg").closest(".ui-wrapper"),70);p(g("#drawImg").closest(".ui-wrapper"),80);p(g("#joinNumLine"),76);p(g("#drawInfo"),76);p(g("#ruleImg"),600);if(g_config.style==68){p(g("#joinNumLine"),102);p(g("#titleImg").closest(".ui-wrapper"),101)}function p(v,u){v.css("z-index",u)}var s="#theGetPricePic,#theGetPricePicTwo,#theGetPricePicThree";var s=g_config.style=="75"?s+",#xydzpAgainImg":s;g(s).setResizableOption({containment:".cannotGetThePriceBox",}).setDraggableOption({containment:".cannotGetThePriceBox",});if(!_preview){g("#resule-gift-sucImg").setResizableOption({handles:"s,e,w,se,sw",dxRatio:2,containment:".imgContentLimit",}).addResizableFn("start",function(u,v){g(this).add(g(this).parent()).css({"max-height":(parseInt(g("#resule-gift-scrollWrap").css("height"))-g(this).offset().top)/g_rem+"rem"})}).addResizableFn("resize",function(v,w){g(this).add(g(this).parent()).css({left:0,top:0,});var u=parseInt(g("#resule-gift-scrollWrap").css("height"))-g(this).offset().top;if(g(this).height()>u){g(this).add(g(this).parent()).css({"max-height":u/g_rem+"rem"})}});j.moduleSlaveImgResize(g("#resule-gift-sucImg"),{width:o[0].aimgw,height:o[0].aimgh})}j.sortRuleBox.addBtn();hg.on("save",function(u){var v="";g("#ruleBox .poupLine").each(function(x,y){var w=g(this).data("sortkey");if(w){v+=w}});u.rulesortstr=v});(function(){var u=".home,.gameBgBox";if(g_config.style==34){u="#gameTopBar,#gameLayerBox1,#gameLayerBox2,#gameLayerBox3"}else{if(g_config.style==45||g_config.style==60){u=".gameInfoBoxMain"}else{if(g_config.style==48){u="#gameContent"}else{if(g_config.style==9||g_config.style==58){u="#openBox"}else{if(g_config.style==54){u=".home"}else{if(g_config.style==57){u=".home"}else{if(g_config.style==65){u=".home"}else{if(g_config.style==68){u=".home"}else{if(g_config.style==52||g_config.style==61){u="#gameBoxPage"}else{if(g_config.style==47){u=".home"}else{if((g_config.style==49)||(g_config.style==69)){u=".body"}else{if(g_config.style==66){u=".home"}else{if(g_config.style==67){u=".myCutDownPriceList"}else{if(g_config.style==77){u=".cutDetailPage"}else{if(g_config.style==70){u=".gameInfoBoxMain"}else{if(g_config.style!=0&&g_config.style!=1&&g_config.style!=2&&g_config.style!=24&&g_config.style!=50&&g_config.style!=75&&g_config.style!=79){u=".gameBgBox"}else{if(g_config.style==50){u=".home"}}}}}}}}}}}}}}}}}$$(function(){if(hg.sound.list&&hg.sound.list.length>0||parent.game.$$isHaveTimeSetting||parent.game.$$isHaveScore){v()}function v(){var w="游戏设置";parent.Edit.addEditBtn({name:w,selecter:u,onclick:function(){parent.Edit.showEditByGame(-4,"",[]);return false},filter:function(x){return g(x).closest(".advertisingBox,.friendEnter").length==0}})}});$$(function(){if(g_config.style==49||g_config.style==67||g_config.style==77||g_config.style==69||g_config.style==71||g_config.style==75||g_config.style==84){return}var v={"#homeBg":n.homeBgPath_def,"#gameBg2":n.gameBg2Path_def,"#gameBg":n.gameBgPath_def};j.saveModuleLayerImg(function(){var w=g.extend({},v);if(hg.edit&&hg.edit.bgList){g.each(hg.edit.bgList,function(x,y){w[y.from]=y.defSrc})}return w});parent.Edit.addEditBtn({name:"编辑背景",selecter:"#ruleImg,.home,.gameBgBox,.gameBgBox2",onclick:function(){var A={title:"背景图片",size:"640px*1136px",limit:"5000k",_flag:-1,};var w=false;if(hg.edit&&hg.edit.bgList){var z,y;for(var x=hg.edit.bgList.length-1;x>=0;x--){z=hg.edit.bgList[x];y=g(z.from);if(y.length>0&&y.eq(0).is(":visible")){y.removeClass("hd-game-theBg-fillAuto");g.extend(A,z);w=true;break}}}if(!w){if(g(".home").is(":visible")){A.from="#homeBg"}else{if(g(".gameBgBox2").is(":visible")){A.from="#gameBg2"}else{if(g(".gameBgBox").is(":visible")){A.from="#gameBg"}}}A.defSrc=v[A.from]}hg.fire("editBackground",A,w);parent.Edit.showEditByGame(A._flag,"",[A]);return false},filter:function(w){if(g_config.style==59){if(g(w).closest(".titleImg").length>0){return g(".body").find("#homeBgBox:visible").length>0}return true}else{if(g_config.style==78){if(g(w).attr("id")=="ruleImg"){return g(".body").find(".basePage:visible").hasClass("home")}return true}}return true}})})})();hg.edit&&hg.edit.setAllEdit();startBtnDelay()}})(jQuery,HdGame);