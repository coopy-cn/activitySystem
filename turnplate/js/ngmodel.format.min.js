"use strict";(function(b,d){d.module("ngmodel.format",[]).constant("modelFormatConfig",{currency:{formatter:function(j){var h=j.$modelValue,k=j.$filter,i=j.$attrs,m=j.$eval;var l=k("currency")(h);return i.prefixed&&m(i.prefixed)?l:l.substr(1)},parser:function(j){var k=j.$viewValue;var i=k.replace(/[^0-9.]/g,"");var h=parseFloat(i,10);return isNaN(h)?j.$valDef:parseFloat(h.toFixed(2))},isEmpty:function(h){return !h.$modelValue},keyDown:function(i){var j=i.$event,k=i.$viewValue,h=i.$modelValue;if(!(b.keyHelper.smallKeyBoard(j)||b.keyHelper.numberKeyBpoard(j)||b.keyHelper.functionKeyBoard(j)||b.keyHelper.currencyKeyBoard(j,k)||b.keyHelper.floatKeyBoard(j,k))){j.stopPropagation();j.preventDefault()}}},digit:{formatter:function(h){return h.$modelValue},parser:function(h){return h.$viewValue?h.$viewValue.replace(/[^0-9]/g,""):h.$valDef},isEmpty:function(h){return !h.$modelValue},keyDown:function(h){var i=h.$event;if(!(b.keyHelper.smallKeyBoard(i)||b.keyHelper.numberKeyBpoard(i)||b.keyHelper.functionKeyBoard(i))){i.stopPropagation();i.preventDefault()}}},"int":{formatter:function(h){return h.$modelValue},parser:function(h){var i=parseInt(h.$viewValue.replace(/[^0-9]/g,""),10);return isNaN(i)?h.$valDef:i},isEmpty:function(h){return isNaN(parseInt(h.$modelValue))},keyDown:function(h){var i=h.$event;if(!(b.keyHelper.smallKeyBoard(i)||b.keyHelper.numberKeyBpoard(i)||b.keyHelper.functionKeyBoard(i))){i.stopPropagation();i.preventDefault()}}},"float":{formatter:function(h){return h.$modelValue},parser:function(h){var i=parseFloat(h.$viewValue.replace(/[^0-9.]/g,""));return isNaN(i)?h.$valDef:i},isEmpty:function(h){return isNaN(parseFloat(h.$modelValue))},keyDown:function(h){var i=h.$event,j=h.$viewValue;if(!(b.keyHelper.smallKeyBoard(i)||b.keyHelper.numberKeyBpoard(i)||b.keyHelper.functionKeyBoard(i)||b.keyHelper.floatKeyBoard(i,j))){i.stopPropagation();i.preventDefault()}}},"boolean":{formatter:function(i){var h=i.$modelValue;if(!d.isUndefined(h)){return h.toString()}},parser:function(h){var i=h.$viewValue;if(!d.isUndefined(i)){return i.trim()==="true"}},isEmpty:function(h){return d.isUndefined(h)}},url:{formatter:function(h){return h.$modelValue},parser:function(h){return hdFai.fixUrl(h.$viewValue)},isEmpty:function(h){return h===""}}}).directive("modelFormat",["modelFormatConfig","$filter","$parse",function(h,j,i){return{require:"ngModel",link:function(r,n,q,k){var m=q.modelFormat.split(/\s/);var p=undefined;var l={};var s=function(t){d.extend(l,t)};if(h[m[0]]){s(h[m.shift()])}d.forEach(m,function(t){r.$watch(t,s,true);s(r.$$watchers[0].get(r))});var o=function(){return i(q.ngModel)(r)};if(q.formatDefval){r.$watch(q.formatDefval,function(t){p=t})}if(l.keyDown){n.bind("blur",function(){n.val(l.formatter({"$modelValue":o(),"$filter":j,"$attrs":q,"$eval":r.$eval}))}).bind("keydown",function(t){l.keyDown({"$event":t,"$viewValue":n.val(),"$modelValue":o(),"$attrs":q,"$eval":r.$eval,"$ngModelCtrl":k})})}k.$parsers.push(function(t){return l.parser({"$viewValue":t,"$attrs":q,"$eval":r.$eval,"$valDef":p})});k.$formatters.push(function(t){return l.formatter({"$modelValue":t,"$filter":j,"$attrs":q,"$eval":r.$eval})});k.$isEmpty=function(t){return l.isEmpty({"$modelValue":t,"$attrs":q,"$eval":r.$eval})}}}}]).directive("checkBoxToArray",[function(){return{restrict:"A",require:"ngModel",link:function(j,i,h,l){var k=j.$eval(h.checkBoxToArray);l.$parsers.push(function(n){var m=l.$modelValue?d.copy(l.$modelValue):[];if(n===true&&m.indexOf(k)===-1){m.push(k)}if(n!==true&&m.indexOf(k)!=-1){m.splice(m.indexOf(k),1)}return m.sort()});l.$formatters.push(function(m){return m&&m.indexOf(k)!=-1});l.$isEmpty=function(m){return !m||m.length===0}}}}]);var e=function(h){var i=h.which;return(i>=96&&i<=105)};var f=function(h){var i=h.which;return(i>=48&&i<=57)&&!h.shiftKey};var c=function(h){var i=h.which;return(i<=40)||(navigator.platform.indexOf("Mac")>-1&&h.metaKey)||(navigator.platform.indexOf("Win")>-1&&h.ctrlKey)};var g=function(h,i){var j=h.which;return(i.toString().indexOf("$")===-1&&j===52&&h.shiftKey)};var a=function(h,i){var j=h.which;return[188].indexOf(j)!=-1||(j===190||j===110)&&i.toString().indexOf(".")===-1};b.keyHelper={smallKeyBoard:e,numberKeyBpoard:f,functionKeyBoard:c,currencyKeyBoard:g,floatKeyBoard:a}})(this,angular);